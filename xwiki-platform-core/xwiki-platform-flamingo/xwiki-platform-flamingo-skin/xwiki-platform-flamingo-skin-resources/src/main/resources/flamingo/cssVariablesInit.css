## ---------------------------------------------------------------------------
## See the NOTICE file distributed with this work for additional
## information regarding copyright ownership.
##
## This is free software; you can redistribute it and/or modify it
## under the terms of the GNU Lesser General Public License as
## published by the Free Software Foundation; either version 2.1 of
## the License, or (at your option) any later version.
##
## This software is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
## Lesser General Public License for more details.
##
## You should have received a copy of the GNU Lesser General Public
## License along with this software; if not, write to the Free
## Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
## 02110-1301 USA, or see the FSF site: http://www.fsf.org.
## ---------------------------------------------------------------------------
#set ($themeDocFullName = "$!xwiki.getUserPreference('colorTheme')")
#if ($themeDocFullName == '')
#set ($themeDocFullName = 'ColorThemes.DefaultColorTheme')
#end
#set ($themeDoc = $xwiki.getDocument($themeDocFullName))
#set ($themeObj = $themeDoc.getObject('FlamingoThemesCode.ThemeClass'))
## List of all the variables available to customize directly in the Flamingo theme editor.
## The key is the name and the value is the CSS type of the variable.
#set($colorThemeVariables = {
"text-color": "color",
"body-bg": "color",
"xwiki-page-content-bg" : "color",
"font-family-base": "text",
"link-color": "color",
"brand-primary": "color",
"brand-success": "color",
"brand-info": "color",
"brand-warning": "color",
"brand-danger": "color",
"headings-color": "color",
"component-active-color" : "color",
"component-active-bg" : "color",
"font-family-base": "text",
"font-family-sans-serif": "text",
"font-family-serif": "text",
"font-family-monospace": "font",
"font-size-base" : "size",
"btn-font-weight" : "size",
"btn-default-color" : "color",
"btn-default-bg" : "color",
"btn-primary-color" : "color",
"btn-primary-bg" : "color",
"btn-success-color" : "color",
"btn-success-bg" : "color",
"btn-info-color" : "color",
"btn-info-bg" : "color",
"btn-warning-color" : "color",
"btn-warning-bg" : "color",
"btn-danger-color" : "color",
"btn-danger-bg" : "color",
"btn-default-border" : "color",
"navbar-default-color" : "color",
"navbar-default-bg" : "color",
"navbar-default-link-color" : "color",
"navbar-default-link-hover-color" : "color",
"navbar-default-link-hover-bg" : "color",
"navbar-default-link-active-color" : "color",
"navbar-default-link-active-bg": "color",
"navbar-height" : "size",
"dropdown-bg" : "color",
"dropdown-border" : "color",
"dropdown-link-color" : "color",
"dropdown-link-hover-color" : "color",
"dropdown-link-hover-bg" : "color",
"dropdown-divider-bg" : "color",
"input-bg" : "color",
"input-border" : "color",
"input-color" : "color",
"input-border-focus" : "color",
"input-color-placeholder" : "color",
"legend-color" : "color",
"legend-border-color": "color",
"panel-bg" : "color",
"panel-default-text" : "color",
"panel-header-text" : "color",
"breadcrumb-bg": "color",
"breadcrumb-color": "color",
"breadcrumb-link-color": "color",
"breadcrumb-separator": "escapedText",
"table-bg": "color",
"table-bg-hover": "color",
"table-border-color": "color"
})
## List of all the variables set in XWiki standard for various purposes.
## Those should all be defined in variables.less
#set($miscVariables = {
"figure-caption-font-size": "90%",
"figure-caption-color": "@text-muted",
"loginFormMaxWidth": "450px",
"login-form-max-width": "450px",
"target-size-minimum": "24px",
"target-size-recommended": "44px",
"breadcrumb-link-color": "@link-color",
"border-width": "1px",
"headings-font-weight": "400",
"nav-tabs-active-link-hover-bg": "@xwiki-page-content-bg",
"border-radius-base": "7px",
"border-radius-large": "10px",
"border-radius-small": "5px",
"button-spacing": "2px",
"button-border-width": "1px",
"edit-section-relative-height": ".7",
"main-padding": "@grid-gutter-width * 2",
"font-size-headings-scale": "1.190",
"font-size-headings-scale-min": "1.125",
"min-screen-size": "768",
"max-screen-size": "1200",
"min-h1-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale-min, 4))))",
"max-h1-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale, 4))))",
"min-h2-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale-min, 3))))",
"max-h2-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale, 3))))",
"min-h3-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale-min, 2))))",
"max-h3-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale, 2))))",
"min-h4-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale-min, 1))))",
"max-h4-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale, 1))))", 
"min-h6-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale-min, -1))))",
"max-h6-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale, -1))))",
"min-document-title-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale-min, 5))))",
"max-document-title-font-size": "unit(ceil((@font-size-base * pow(@font-size-headings-scale, 5))))",
"font-size-document-title": "max(@{min-document-title-font-size}px, min(@{max-document-title-font-size}px, calc(@{min-document-title-font-size}px + (@{max-document-title-font-size} - @{min-document-title-font-size}) * (100vw - @{min-screen-size}px) / (@{max-screen-size} - @{min-screen-size}))))",
"font-size-h1": "max(@{min-h1-font-size}px, min(@{max-h1-font-size}px, calc(@{min-h1-font-size}px + (@{max-h1-font-size} - @{min-h1-font-size}) * (100vw - @{min-screen-size}px) / (@{max-screen-size} - @{min-screen-size}))))",
"font-size-h2": "max(@{min-h2-font-size}px, min(@{max-h2-font-size}px, calc(@{min-h2-font-size}px + (@{max-h2-font-size} - @{min-h2-font-size}) * (100vw - @{min-screen-size}px) / (@{max-screen-size} - @{min-screen-size}))))",
"font-size-h3": "max(@{min-h3-font-size}px, min(@{max-h3-font-size}px, calc(@{min-h3-font-size}px + (@{max-h3-font-size} - @{min-h3-font-size}) * (100vw - @{min-screen-size}px) / (@{max-screen-size} - @{min-screen-size}))))",
"font-size-h4": "max(@{min-h4-font-size}px, min(@{max-h4-font-size}px, calc(@{min-h4-font-size}px + (@{max-h4-font-size} - @{min-h4-font-size}) * (100vw - @{min-screen-size}px) / (@{max-screen-size} - @{min-screen-size}))))",
"font-size-h5": "@font-size-base",
"font-size-h6": "max(@{min-h6-font-size}px, min(@{max-h6-font-size}px, calc(@{min-h6-font-size}px + (@{max-h6-font-size} - @{min-h6-font-size}) * (100vw - @{min-screen-size}px) / (@{max-screen-size} - @{min-screen-size}))))"
})
:root {
## Create CSS variables for each colorTheme variable
#foreach($property in $colorThemeVariables.keySet())
#set($value = $themeDoc.getValue($property, $themeObj))
#if("$!value" != '')
## If the value we want to set is a LESS variables, we make sure to convert it into a CSS variable.
#if($stringtool.startsWith($!value, '@'))
#set($value = 'var(--' + $stringtool.substring($value, 1) + ')')
#end
#set($propertyType = $colorThemeVariables.get($property))
## For now we just use only `string` variables, because it's the easiest to setup and because it's 100% compatible with 
## LESS variables. We could use extra info on the variable types to use @property syntax later.
#if($propertyType == 'escapedText')
--$property: "$escapetool.javascript($!value)";
#else
--$property: $!value;
#end
#end
#end

#foreach($property in $miscVariables.keySet())
#set($value = $miscVariables.get($property))
#if("$!value" != '')
## If the value we want to set is a LESS variables, we make sure to convert it into a CSS variable.
#if($stringtool.startsWith($!value, '@'))
#set($value = 'var(--' + $stringtool.substring($value, 1) + ')')
#end
## For now we just use only `string` variables, because it's the easiest to setup and because it's 100% compatible with
## LESS variables. We could use extra info on the variable types to use @property syntax later.
--$property: $escapetool.javascript($!value);
#end
#end
}